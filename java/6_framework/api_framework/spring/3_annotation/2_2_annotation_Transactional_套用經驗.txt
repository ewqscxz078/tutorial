ref ChatGPT

1.@Transactional æ‡‰è©²æ¨™è¨»åœ¨å“ªå€‹å±¤ç´šï¼Ÿ
	å…¸å‹çš„ä¸‰å±¤æ¶æ§‹ï¼ˆController â†’ Service â†’ DAO/Repositoryï¼‰ä¸­ï¼Œæœ€é©åˆå°‡ @Transactional æ¨™è¨»åœ¨ Service å±¤çš„æ–¹æ³•ä¸Šï¼ŒåŸå› å¦‚ä¸‹
		Service å±¤æ˜¯æ¥­å‹™é‚è¼¯çš„æ ¸å¿ƒï¼Œæ‡‰è©²æ˜¯äº¤æ˜“çš„é‚Šç•Œï¼Œé€™æ¨£å¯ä»¥ç¢ºä¿åŒä¸€å€‹æ¥­å‹™é‚è¼¯çš„æ‰€æœ‰ DB æ“ä½œéƒ½åœ¨åŒä¸€å€‹äº¤æ˜“å…§ã€‚
		Controller å±¤ä¸æ‡‰è©²ç®¡ç†äº¤æ˜“ï¼Œå®ƒçš„è²¬ä»»æ‡‰è©²æ˜¯è™•ç†è«‹æ±‚èˆ‡éŸ¿æ‡‰ï¼Œä¸æ‡‰æ¶‰åŠäº¤æ˜“ç®¡ç†ã€‚
		Repository å±¤ï¼ˆJPA Repositoryï¼‰ä¹Ÿä¸æ‡‰è©²æ¨™è¨» @Transactionalï¼ŒSpring Data JPA å…§éƒ¨å·²ç¶“æœ‰è‡ªå·±çš„æ©Ÿåˆ¶ä¾†è™•ç†ç°¡å–®çš„ CRUD æ“ä½œï¼Œå®ƒå€‘æ‡‰è©²ç”±ä¸Šå±¤çš„ Service å±¤ä¾†æ§åˆ¶äº¤æ˜“ç¯„åœã€‚

		ç¯„ä¾‹
			@Service
			public class OrderService {

				@Transactional
				public void createOrder(OrderRequest request) {
					// 1. æª¢æŸ¥åº«å­˜
					inventoryService.checkStock(request.getProductId());

					// 2. å‰µå»ºè¨‚å–®
					Order order = new Order(request);
					orderRepository.save(order);

					// 3. æ‰£åº«å­˜
					inventoryService.deductStock(request.getProductId(), request.getQuantity());
				}
			}

2.@Transactional éœ€è¦æ¨™è¨»åœ¨ class é‚„æ˜¯ methodï¼Ÿ
	1.ä¸€èˆ¬ä¾†èªªï¼Œæ¨™è¨»åœ¨æ–¹æ³•å±¤ç´šæ¯”è¼ƒéˆæ´»ï¼Œå¯ä»¥æ ¹æ“šä¸åŒçš„æ–¹æ³•è¨­å®šä¸åŒçš„ propagationã€‚
		@Service
		@Transactional // é€™è£¡æ¨™è¨»åœ¨ class ä¸Šï¼Œæ‰€æœ‰ public æ–¹æ³•éƒ½æœƒå•Ÿç”¨äº¤æ˜“
		public class OrderService {
			public void createOrder(...) { ... }
			public void cancelOrder(...) { ... }
		}

	2.å¦‚æœä¸€å€‹ class è£¡çš„æ‰€æœ‰ public æ–¹æ³•éƒ½æ‡‰è©²å•Ÿå‹•äº¤æ˜“ï¼Œå¯ä»¥ç›´æ¥æ¨™è¨»åœ¨ class ä¸Šã€‚
		@Service
		public class OrderService {
			@Transactional
			public void createOrder(...) { ... }

			@Transactional(readOnly = true) // æŸ¥è©¢æ™‚ä½¿ç”¨ readOnlyï¼Œå¯ä»¥æå‡æ•ˆèƒ½
			public Order findOrder(...) { ... }
		}

3.@Transactional åœ¨ Component é¡åˆ¥å…§ä½¿ç”¨ï¼Ÿ
	Spring çš„ @Component å…§éƒ¨é€šå¸¸ä¸å»ºè­°ç›´æ¥ä½¿ç”¨ @Transactionalï¼Œå› ç‚ºï¼š
		1.å¦‚æœ Component å…§çš„æ–¹æ³•æ²’æœ‰è¢« Service å±¤å‘¼å«ï¼Œè€Œæ˜¯è‡ªå·±å…§éƒ¨å‘¼å«è‡ªå·±ï¼ŒAOP å¯èƒ½ç„¡æ³•ç”Ÿæ•ˆã€‚
		2.é€™æ¨£æœƒè®“äº¤æ˜“æ§åˆ¶è®Šå¾—é›£ä»¥ç¶­è­·
	æœ€ä½³å¯¦è¸ï¼š
		è®“ Service ä¾†æ§åˆ¶äº¤æ˜“ï¼ŒComponent åªå°ˆæ³¨æ–¼åŠŸèƒ½æ¨¡çµ„ã€‚
		è‹¥ä¸€å®šè¦ä½¿ç”¨ @Transactionalï¼Œè«‹ç¢ºä¿ Component æ˜¯ç”± Spring ç®¡ç†ï¼Œä¸¦ä¸”è¢« Service ä»¥ã€Œå¤–éƒ¨æ–¹å¼ã€å‘¼å«ã€‚
			@Component
			public class NotificationService {
				@Transactional
				public void sendEmail(...) {
					// ç™¼é€ emailï¼Œé€™æ¨£æœƒå•Ÿå‹•æ–°çš„äº¤æ˜“
				}
			}

			ä½†å¦‚æœ NotificationService.sendEmail() æ˜¯è¢«è‡ªå·±å…§éƒ¨æ–¹æ³•å‘¼å«ï¼Œå¯èƒ½æœƒå› ç‚º AOP ä»£ç†æ©Ÿåˆ¶ç„¡æ³•ç”Ÿæ•ˆï¼Œå°è‡´ @Transactional å¤±æ•ˆã€‚

4. AOP æ–¹å¼æ§åˆ¶äº¤æ˜“ vs. @Transactional
	AOP æ–¹å¼ç¢ºå¯¦å¯ä»¥ç”¨ä¾†æ§åˆ¶äº¤æ˜“ï¼Œä½†è¦ç‰¹åˆ¥æ³¨æ„ï¼š
		1.ç¶­è­·æˆæœ¬é«˜ï¼šé–‹ç™¼äººå“¡éœ€è¦ç†Ÿæ‚‰ AOPï¼Œä¸” AOP åˆ‡é¢å¿…é ˆè€ƒæ…®åˆ° Propagationã€‚
		2.å¯èƒ½å°è‡´éé æœŸçš„äº¤æ˜“å•é¡Œï¼šå¦‚æœæ²’å¯«å¥½ï¼Œå¯èƒ½æœƒç„¡æ³•é æ¸¬æŸå€‹æ–¹æ³•æ˜¯å¦åœ¨äº¤æ˜“å…§åŸ·è¡Œã€‚
	å»ºè­°åšæ³•ï¼š
		1.äº¤æ˜“é‚„æ˜¯æ‡‰è©²ä½¿ç”¨ @Transactionalï¼ŒAOP å¯ç”¨ä¾† ç›£æ§äº¤æ˜“è¡Œç‚ºï¼ˆå¦‚è¨˜éŒ„äº¤æ˜“é–‹å§‹/çµæŸã€ç›£æ¸¬è¶…æ™‚ç­‰ï¼‰ã€‚
			ç¤ºä¾‹ï¼šé€é AOP ç›£æ§äº¤æ˜“ç‹€æ…‹
				@Aspect
				@Component
				public class TransactionMonitorAspect {
					@Before("@annotation(org.springframework.transaction.annotation.Transactional)")
					public void beforeTransaction(JoinPoint joinPoint) {
						log.info("äº¤æ˜“é–‹å§‹: " + joinPoint.getSignature());
					}

					@After("@annotation(org.springframework.transaction.annotation.Transactional)")
					public void afterTransaction(JoinPoint joinPoint) {
						log.info("äº¤æ˜“çµæŸ: " + joinPoint.getSignature());
					}
				}

		2.é™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¦å‰‡ä¸å»ºè­°å®Œå…¨ä¾è³´ AOP ä¾†æ§åˆ¶äº¤æ˜“ã€‚


ç¸½çµ
	äº¤æ˜“ç®¡ç†ç­–ç•¥
		@Transactional æ‡‰è©²æ”¾å“ªè£¡ï¼Ÿ
			Service å±¤æ–¹æ³•ï¼Œä¸æ‡‰è©²æ”¾åœ¨ Controller æˆ– Repository
		æ¨™è¨»åœ¨ Class é‚„æ˜¯ Methodï¼Ÿ
			Method å„ªå…ˆï¼Œå¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½éœ€äº¤æ˜“å¯æ¨™è¨»åœ¨ Class
		Propagation è¨­å®šï¼Ÿ
			é è¨­ REQUIREDï¼Œç¨ç«‹äº¤æ˜“ç”¨ REQUIRES_NEWï¼ŒæŸ¥è©¢ç”¨ readOnly = true
		Component å…§éƒ¨ä½¿ç”¨ï¼Ÿ
			é€é Service å±¤èª¿ç”¨ï¼Œé¿å…è‡ªå·±èª¿ç”¨è‡ªå·±å°è‡´ AOP å¤±æ•ˆ
		AOP æ§åˆ¶äº¤æ˜“ï¼Ÿ
			ä¸å»ºè­°ï¼Œä½†å¯ç”¨ä¾†ç›£æ§äº¤æ˜“è¡Œç‚º


å¸¸è¦‹å•é¡Œ
	Q1:service class ä¸Šå®£å‘Š @Transactional æœ‰äº›æ–¹æ³•ä¸¦ééœ€è¦äº¤æ˜“æ™‚æœƒå½±éŸ¿æ•ˆèƒ½?
	A1:Service é¡ä¸Šå…¨å±€å®£å‘Š @Transactionalï¼ˆå³æ¨™è¨»åœ¨ class ç´šåˆ¥ï¼‰æ™‚ï¼Œæ‰€æœ‰å…¬é–‹æ–¹æ³•ï¼ˆpublicï¼‰éƒ½æœƒè¢« Spring ä»£ç†ä¸¦å¥—ç”¨äº¤æ˜“ï¼Œå³ä½¿æŸäº›æ–¹æ³•ä¸éœ€è¦äº¤æ˜“ã€‚é€™æ¨£å¯èƒ½æœƒå½±éŸ¿æ•ˆèƒ½ï¼Œä¸»è¦åŸå› å¦‚ä¸‹ï¼š
		1. å½±éŸ¿æ•ˆèƒ½çš„ä¸»è¦åŸå› 
			1.ä¸å¿…è¦çš„ Transaction Overhead
				æ¯æ¬¡åŸ·è¡Œé€™äº›æ–¹æ³•æ™‚ï¼ŒSpring ä»æœƒé€²è¡Œ äº¤æ˜“çš„é–‹å§‹ (begin transaction) å’Œæäº¤ (commit transaction)ï¼Œå³ä½¿è©²æ–¹æ³•æ²’æœ‰æ•¸æ“šåº«å¯«å…¥æ“ä½œã€‚
				é€™æœƒå¢åŠ  JDBC é€£æ¥çš„é–‹éŠ·ï¼Œç‰¹åˆ¥æ˜¯å°æ–¼æŸ¥è©¢é¡ (findById() é€™é¡) æ–¹æ³•ã€‚
			2.æŸ¥è©¢æ“ä½œå¤šé¤˜çš„ ACID ä¿è­‰
				@Transactional é è¨­æ˜¯ readOnly = falseï¼Œæœƒå‘ŠçŸ¥åº•å±¤çš„ JPAï¼ˆæˆ– Hibernateï¼‰é–‹å•Ÿä¸€å€‹ å¯å¯«å…¥çš„äº¤æ˜“ï¼Œå³ä½¿è©²æ–¹æ³•åªæ˜¯åŸ·è¡ŒæŸ¥è©¢ï¼Œé€™å¯èƒ½æœƒå°è‡´ï¼š
					Hibernate ç”¢ç”Ÿä¸å¿…è¦çš„é–ï¼ˆç‰¹åˆ¥æ˜¯ repeatable read æˆ– serializable é€™é¡éš”é›¢ç´šåˆ¥ï¼‰ã€‚
					å½±éŸ¿è³‡æ–™åº«æ•ˆèƒ½ï¼Œå› ç‚ºéƒ¨åˆ†è³‡æ–™åº«åœ¨ @Transactional ä¸‹å¯èƒ½æœƒä»¥ä¸€è‡´æ€§å¿«ç…§ä¾†åŸ·è¡ŒæŸ¥è©¢ï¼Œå°è‡´é¡å¤–çš„è² æ“”ã€‚
			3.éäº¤æ˜“æ–¹æ³•ä»è¢«ä»£ç†
				Spring ä½¿ç”¨ AOP ä»£ç† (CGLIB æˆ– JDK Dynamic Proxy) ä¾†ç®¡ç† @Transactional æ–¹æ³•ï¼Œå› æ­¤å³ä½¿æŸäº›æ–¹æ³•ä¸éœ€è¦äº¤æ˜“ï¼Œå®ƒå€‘ä»æœƒè¢«ä»£ç†ï¼Œå¸¶ä¾†é¡å¤–çš„ä»£ç†å±¤é–‹éŠ·ã€‚
		2. è§£æ±ºæ–¹æ¡ˆï¼šæ–¹æ³•ç´šåˆ¥æ§åˆ¶
			å»ºè­°åšæ³• æ˜¯ åƒ…åœ¨éœ€è¦äº¤æ˜“çš„æ–¹æ³•ä¸Šæ¨™è¨» @Transactionalï¼Œä¸è¦åœ¨ class ä¸Šå®£å‘Šï¼Œé€™æ¨£å¯ä»¥é¿å…éå¿…è¦çš„äº¤æ˜“é–‹éŠ·ã€‚
				ä¾‹å¦‚ï¼š
					@Service
					public class OrderService {

						@Transactional // éœ€è¦äº¤æ˜“
						public void createOrder(OrderRequest request) {
							// 1. æª¢æŸ¥åº«å­˜
							inventoryService.checkStock(request.getProductId());

							// 2. å‰µå»ºè¨‚å–®
							Order order = new Order(request);
							orderRepository.save(order);

							// 3. æ‰£åº«å­˜
							inventoryService.deductStock(request.getProductId(), request.getQuantity());
						}

						@Transactional(propagation = Propagation.REQUIRES_NEW) // éœ€è¦ç¨ç«‹äº¤æ˜“
						public void processPayment(PaymentRequest request) {
							paymentRepository.save(request);
						}

						@Transactional(readOnly = true) // æŸ¥è©¢é¡æ‡‰ä½¿ç”¨ readOnly æé«˜æ•ˆèƒ½
						public Order findOrder(Long orderId) {
							return orderRepository.findById(orderId).orElse(null);
						}

						public void sendNotification(String message) {
							// ä¸éœ€è¦äº¤æ˜“çš„æ“ä½œï¼Œä¾‹å¦‚ç™¼é€é€šçŸ¥
							notificationService.sendEmail(message);
						}
					}
				é€™æ¨£åšçš„å¥½è™•ï¼š
					1.æŸ¥è©¢æ–¹æ³• (findOrder()) ä½¿ç”¨ readOnly = trueï¼Œå¯è®“ Hibernate é¿å…ä¸å¿…è¦çš„å¿«å–åŒæ­¥ (flush)ï¼Œæå‡æ•ˆèƒ½ã€‚
					2.éäº¤æ˜“æ–¹æ³• (sendNotification()) æ²’æœ‰ @Transactionalï¼Œé¿å… Spring ä»£ç†å°è‡´çš„é¡å¤–é–‹éŠ·ã€‚
					3.äº¤æ˜“æ–¹æ³• (createOrder()ã€processPayment()) ä»æœ‰æ­£ç¢ºçš„äº¤æ˜“ç®¡ç†ã€‚

		3. ä»€éº¼æ™‚å€™ @Transactional æ¨™åœ¨ class ä¸Šæ¯”è¼ƒé©åˆï¼Ÿ
			åœ¨æŸäº›å ´æ™¯ä¸‹ï¼Œä»ç„¶å¯ä»¥è€ƒæ…®å°‡ @Transactional æ¨™è¨»åœ¨ class ç´šåˆ¥ï¼š
				1.å¦‚æœè©² Service çš„æ‰€æœ‰æ–¹æ³•éƒ½ç¢ºå®šéœ€è¦äº¤æ˜“
					ä¾‹å¦‚ã€Œåƒ…è² è²¬è³‡æ–™å¯«å…¥ã€æ›´æ–°ã€åˆªé™¤çš„ Serviceã€ï¼Œå¯ä»¥ç›´æ¥æ¨™è¨»åœ¨ classï¼š
						@Service
						@Transactional
						public class UserService {
							public void createUser(User user) { userRepository.save(user); }
							public void updateUser(User user) { userRepository.save(user); }
							public void deleteUser(Long userId) { userRepository.deleteById(userId); }
						}
						é€™ç¨®æƒ…æ³ä¸‹ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ¶‰åŠäº¤æ˜“ï¼Œæ¨™åœ¨ class å±¤ç´šæ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ç‚ºçœç•¥æ–¹æ³•ç´šåˆ¥çš„ @Transactional ä¸¦ä¸æœƒå½±éŸ¿æ•ˆèƒ½ã€‚
				2.æ‰¹æ¬¡ä½œæ¥­ï¼ˆBatch Jobï¼‰
					è‹¥æ•´å€‹æ‰¹æ¬¡ä½œæ¥­éƒ½æ‡‰è©²é‹è¡Œåœ¨ å–®ä¸€äº¤æ˜“ä¸­ï¼Œå‰‡å¯æ¨™è¨»åœ¨ class ä¸Šï¼š
						@Service
						@Transactional
						public class BatchProcessingService {
							public void processLargeDataset() {
								// è®€å– & è™•ç†å¤§é‡æ•¸æ“š
								List<Data> dataList = dataRepository.findAll();
								dataList.forEach(this::processItem);
							}
							private void processItem(Data data) { ... }
						}
						åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œæ‰¹æ¬¡æ“ä½œæ‡‰è©² ä¸€æ¬¡æäº¤ï¼Œé¿å…æ¯ç­†è³‡æ–™éƒ½é–‹å•Ÿ/æäº¤äº¤æ˜“ã€‚
		4. @Transactional(readOnly = true) çœŸçš„æœ‰ç”¨å—ï¼Ÿ
			ç‰¹åˆ¥æ˜¯å°æ–¼ ä½¿ç”¨ Hibernate çš„ JPA é …ç›®ï¼ŒreadOnly = true å¯ä»¥é¡¯è‘—æå‡æ•ˆèƒ½ï¼ŒåŸå› å¦‚ä¸‹ï¼š
				1.é¿å… Hibernate åœ¨ flush éšæ®µåŒæ­¥è®Šæ›´ï¼ˆä¸æœƒæª¢æŸ¥ Entity æ˜¯å¦è®Šæ›´ï¼‰ã€‚
				2.æŸäº›è³‡æ–™åº«ï¼ˆå¦‚ PostgreSQLï¼‰æœƒè‡ªå‹•ä½¿ç”¨æ›´è¼•é‡ç´šçš„å¿«å–æ©Ÿåˆ¶ï¼Œå› ç‚ºå®ƒçŸ¥é“é€™å€‹äº¤æ˜“ä¸æœƒè®Šæ›´æ•¸æ“šã€‚

	Q2: @Transactional åœ¨æ–¹æ³•ç´šåˆ¥æ˜¯å¦æœƒè¦†è“‹ class ç´šåˆ¥ï¼Ÿ
	A2: æœƒï¼Spring æœƒæŒ‰ç…§ä»¥ä¸‹å„ªå…ˆé †åºä¾†æ±ºå®š @Transactional è¨­å®šï¼š
		1.æ–¹æ³•ä¸Šçš„ @Transactional è¨­å®šå„ªå…ˆã€‚
		2.å¦‚æœæ–¹æ³•æ²’æœ‰ @Transactionalï¼Œå‰‡ä½¿ç”¨ class ä¸Šçš„ @Transactional è¨­å®šã€‚
		3.å¦‚æœéƒ½æ²’æœ‰ï¼Œå‰‡è©²æ–¹æ³•ä¸æœƒå•Ÿç”¨äº¤æ˜“ã€‚
			@Service
			@Transactional // é è¨­æ‰€æœ‰æ–¹æ³•éƒ½æœ‰äº¤æ˜“ (readOnly = false)
			public class OrderService {

				@Transactional(readOnly = true) // è¦†è“‹ class è¨­å®š
				public Order findOrder(Long orderId) {
					return orderRepository.findById(orderId).orElse(null);
				}

				public void processOrder() {
					// é€™è£¡ä»ç„¶æœƒä½¿ç”¨ class ä¸Šçš„ @Transactional (é è¨­ readOnly = false)
				}
			}

		 æœ€ä½³è¨­è¨ˆå»ºè­°:
			è‹¥ class å…§å¤§éƒ¨åˆ†æ–¹æ³•éœ€è¦äº¤æ˜“ï¼Œä½†æŸ¥è©¢é¡æ–¹æ³•æ‡‰è©²ä½¿ç”¨ readOnly = trueï¼Œå¯ä»¥åœ¨ class ä¸Šæ¨™è¨» @Transactionalï¼Œä¸¦åœ¨æŸ¥è©¢æ–¹æ³•ä¸Šé¡å¤–åŠ  @Transactional(readOnly = true)ã€‚
			è‹¥ class å…§æœ‰éƒ¨åˆ†ä¸éœ€è¦äº¤æ˜“çš„æ–¹æ³•ï¼Œå‰‡æ‡‰åœ¨æ–¹æ³•ä¸Šå€‹åˆ¥æ¨™è¨» @Transactionalï¼Œé¿å… class ä¸Šçš„è¨­å®šå½±éŸ¿éäº¤æ˜“æ–¹æ³•ã€‚

	Q3: class å®£å‘Š @Transactional  éƒ½æœƒå½±éŸ¿ publicã€privateã€protectedã€default æ–¹æ³•?
	A3: @Transactional åªæœƒå½±éŸ¿ public æ–¹æ³•ï¼Œä¸æœƒå½±éŸ¿ private æˆ– protectedã€default æ–¹æ³•ã€‚
		1.é€™æ˜¯å› ç‚º Spring ä½¿ç”¨ AOP ä»£ç†æ©Ÿåˆ¶ä¾†ç®¡ç† @Transactionalï¼Œè€Œ Spring AOP åªæœƒä»£ç† public æ–¹æ³•ã€‚
			ç‚ºä»€éº¼åªå½±éŸ¿ public æ–¹æ³•ï¼Ÿ
				Spring é€é å‹•æ…‹ä»£ç† (Dynamic Proxy) ä¾†æ””æˆªæ–¹æ³•èª¿ç”¨ï¼Œè€Œ JDK ä»£ç† (JDK Dynamic Proxy) åªèƒ½ä»£ç† ä»‹é¢ (interface) çš„ public æ–¹æ³•ã€‚
				å¦‚æœä½¿ç”¨ CGLIB ä»£ç†ï¼Œå®ƒå¯ä»¥ä»£ç†é¡ (class) æœ¬èº«ï¼Œä½†ä¾ç„¶åªæœƒä»£ç† public æ–¹æ³•ï¼Œprivate æ–¹æ³•ä»ç„¶ä¸æœƒè¢«æ””æˆªã€‚
		2. @Transactional åœ¨å…§éƒ¨æ–¹æ³•èª¿ç”¨æ™‚å¯èƒ½ç„¡æ•ˆ
			é‡é»ï¼šå¦‚æœåŒä¸€å€‹ class å…§éƒ¨çš„æ–¹æ³•å‘¼å«å¦ä¸€å€‹ @Transactional æ–¹æ³•ï¼Œå¯èƒ½æœƒå°è‡´äº¤æ˜“ä¸ç”Ÿæ•ˆï¼
				@Service
				@Transactional
				public class OrderService {

					public void createOrder() {
						System.out.println("Public method: äº¤æ˜“ç”Ÿæ•ˆ");
						processOrder(); // å…§éƒ¨å‘¼å«ï¼ŒTransactional ä¸æœƒç”Ÿæ•ˆï¼
					}

					@Transactional(propagation = Propagation.REQUIRES_NEW)
					public void processOrder() {
						System.out.println("Public method: äº¤æ˜“æ‡‰è©²ç”Ÿæ•ˆï¼Œä½†ä¸æœƒï¼");
					}
				}
				çµæœ
					createOrder() âœ… äº¤æ˜“ç”Ÿæ•ˆã€‚
					processOrder() ğŸš¨ ä¸æœƒé–‹å•Ÿæ–°çš„äº¤æ˜“ï¼Œå› ç‚ºå®ƒæ˜¯ç”± createOrder() å…§éƒ¨ç›´æ¥èª¿ç”¨ï¼Œæ²’æœ‰ç¶“é Spring ä»£ç†ï¼Œæ‰€ä»¥ @Transactional(propagation = Propagation.REQUIRES_NEW) ç„¡æ•ˆï¼

			è§£æ³•
				1.ä½¿ç”¨ self-injection
					é€é Spring å–å¾—è‡ªå·±çš„ä»£ç†ç‰©ä»¶ï¼Œè®“æ–¹æ³•é€éä»£ç†å‘¼å«ï¼š
						@Service
						@Transactional
						public class OrderService {
							@Autowired
							private OrderService self; // å–å¾—ä»£ç†ç‰©ä»¶

							public void createOrder() {
								System.out.println("Public method: äº¤æ˜“ç”Ÿæ•ˆ");
								self.processOrder(); // é€éä»£ç†å‘¼å«
							}

							@Transactional(propagation = Propagation.REQUIRES_NEW)
							public void processOrder() {
								System.out.println("Public method: äº¤æ˜“ç”Ÿæ•ˆï¼");
							}
						}
				2.æ‹†åˆ†æˆä¸åŒçš„ Service
					å°‡ processOrder() ç§»åˆ°å¦ä¸€å€‹ Service å…§ï¼Œç¢ºä¿æ–¹æ³•æ˜¯è¢«å¤–éƒ¨ Bean å‘¼å«
						@Service
						public class OrderService {
							@Autowired
							private PaymentService paymentService;

							public void createOrder() {
								System.out.println("Public method: äº¤æ˜“ç”Ÿæ•ˆ");
								paymentService.processOrder();
							}
						}

						@Service
						public class PaymentService {
							@Transactional(propagation = Propagation.REQUIRES_NEW)
							public void processOrder() {
								System.out.println("Public method: äº¤æ˜“ç”Ÿæ•ˆï¼");
							}
						}

