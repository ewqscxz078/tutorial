ref ChatGPT

åœ¨ Spring Authorization Server ä¸­è¨»å†Šä¸€å€‹ RegisteredClient æ˜¯è¨­å®š OAuth2 å®¢æˆ¶ç«¯æˆæ¬Šæµç¨‹çš„æ ¸å¿ƒã€‚ä»¥ä¸‹æ˜¯å¯¦å‹™ä¸Šè¨»å†Š RegisteredClient æ™‚å¸¸è¦‹çš„å¹¾å€‹ä¸»è¦è¦ç´ ï¼Œä¸¦é™„ä¸Šèªªæ˜ï¼š

ğŸ”‘ åŸºæœ¬å±¬æ€§

	| æ¬„ä½            | èªªæ˜                                               |
	| -------------- | ------------------------------------------------- |
	| `id`           | å”¯ä¸€ IDï¼Œå¯ç”¨ `UUID.randomUUID()`                   |
	| `clientId`     | å®¢æˆ¶ç«¯ IDï¼Œæˆæ¬Šæ™‚ç”¨ä¾†è¾¨è­˜ clientï¼ˆä¾‹å¦‚ `my-client-id`ï¼‰ |
	| `clientSecret` | å®¢æˆ¶ç«¯å¯†ç¢¼ï¼Œæ­é… `clientId` ä½¿ç”¨ï¼ˆå¯ç¶“éåŠ å¯†å„²å­˜ï¼‰        |
	| `clientName`   | ï¼ˆé¸å¡«ï¼‰äººé¡å¯è®€çš„ client åç¨±                         |


ğŸ” èªè­‰æ–¹å¼ï¼ˆAuthentication Methodsï¼‰
	| æ–¹æ³•                                              | èªªæ˜                                             |
	| ------------------------------------------------ | ----------------------------------------------- |
	| `ClientAuthenticationMethod.CLIENT_SECRET_BASIC` | é è¨­ï¼Œä½¿ç”¨ HTTP Basic å‚³é€ clientId + clientSecret |
	| `CLIENT_SECRET_POST`                             | å°‡ clientId èˆ‡ clientSecret æ”¾å…¥ request body     |
	| `NONE`                                           | å…¬é–‹ clientï¼ˆç„¡ client secretï¼‰ï¼Œä¾‹å¦‚ public SPA    |

	.clientAuthenticationMethods(auth -> auth.add(ClientAuthenticationMethod.CLIENT_SECRET_BASIC))


ğŸ” æˆæ¬Šé¡å‹ï¼ˆAuthorization Grant Typesï¼‰
	| é¡å‹                  | èªªæ˜                                              |
	| -------------------- | ------------------------------------------------ |
	| `AUTHORIZATION_CODE` | é©ç”¨æ–¼æœ‰å‰ç«¯ä»‹é¢çš„æ‡‰ç”¨ç¨‹å¼ï¼ˆå«ä½¿ç”¨è€…ç™»å…¥ï¼‰                |
	| `CLIENT_CREDENTIALS` | é©ç”¨æ–¼ server-to-server ç„¡ä½¿ç”¨è€…ç™»å…¥å ´æ™¯              |
	| `REFRESH_TOKEN`      | å…è¨± client ä½¿ç”¨ refresh token çºŒæœŸ access token    |
	| `PASSWORD`           | å·²æ£„ç”¨ï¼Œä¸æ¨è–¦ä½¿ç”¨                                   |

	.authorizationGrantType(AuthorizationGrantType.AUTHORIZATION_CODE)
	.authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)


ğŸŒ é‡æ–°å°å‘ URIï¼ˆRedirect URIsï¼‰
	* åƒ… AUTHORIZATION_CODE æˆæ¬Šé¡å‹éœ€è¦
	* å¿…é ˆèˆ‡ client request å®Œå…¨ä¸€è‡´ï¼ˆåŒ…æ‹¬ query stringï¼‰

	.redirectUri("https://example.com/login/oauth2/code/my-client")


ğŸ§¾ ç¯„åœï¼ˆScopesï¼‰
	| ç¯„åœé¡å‹    | èªªæ˜                                           |
	| --------- | ---------------------------------------------- |
	| æ¨™æº– scope | å¦‚ `openid`, `profile`, `email`ï¼ˆOIDCï¼‰         |
	| è‡ªè¨‚ scope | å¦‚ `read`, `write`, `report:generate` ç­‰æ¬Šé™è­˜åˆ¥ |

	.scopes(scopes -> {
		scopes.add("read");
		scopes.add("write");
	})

ğŸ—“ï¸ Token è¨­å®šï¼ˆå¯é¸ï¼‰
	ä½ å¯ä»¥é¡å¤–è¨­å®š token æœ‰æ•ˆæœŸé™ã€reusability ç­‰ï¼š

	.tokenSettings(TokenSettings.builder()
		.accessTokenTimeToLive(Duration.ofMinutes(30))
		.refreshTokenTimeToLive(Duration.ofDays(1))
		.reuseRefreshTokens(true)
		.build())


ğŸ”’ å®¢æˆ¶ç«¯è¨­å®šï¼ˆå¯é¸ï¼‰
	ä¾‹å¦‚æ˜¯å¦è¦æ±‚ä½¿ç”¨è€…ç¢ºèªæˆæ¬Šï¼š

	.clientSettings(ClientSettings.builder()
		.requireAuthorizationConsent(true) // éœ€ä½¿ç”¨è€…åŒæ„ç•«é¢
		.build())
