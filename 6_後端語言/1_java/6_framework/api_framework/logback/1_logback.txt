logback mdc
	https://www.796t.com/content/1541525951.html

logback xml setting
	https://www.cnblogs.com/xrq730/p/8628945.html

https://logback.qos.ch/dependencies.html
	logback 	jdk 	SLF4J
	1.3.x		8 		2
	1.4.x		11		2

	ä½†åœ¨ spring bot 2.7.x ç‰ˆæœ¬ åƒ…æ”¯æ´åˆ° 1.2.x å› ç‚ºå…¶åº•å±¤è™•ç† StaticLoggerBinder in LogbackLoggingSystem.java å•é¡Œ
		https://github.com/qos-ch/logback/issues/745

========================================================================================================================
=================================== maven dependency ===================================================================
========================================================================================================================
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>1.7.30</version>
</dependency>
<dependency>
	<groupId>ch.qos.logback</groupId>
	<artifactId>logback-classic</artifactId>
</dependency>

1. logback-classic : (spring boot starter logging è£¡é¢ä¾è³´çš„ä¹Ÿæ˜¯è©²é …ç›®)
	ç”¨é€”ï¼šé€™æ˜¯æœ€å¸¸ç”¨çš„æ¨¡çµ„ï¼Œç”¨æ–¼ä¸€èˆ¬çš„ Java æ‡‰ç”¨ç¨‹å¼ï¼Œæä¾›æ ¸å¿ƒçš„æ—¥èªŒåŠŸèƒ½ï¼Œä¸¦èˆ‡ SLF4J ä»‹é¢é›†æˆã€‚
	é©ç”¨å ´æ™¯ï¼šç•¶ä½ éœ€è¦åœ¨æ™®é€š Java æ‡‰ç”¨ã€Spring æ‡‰ç”¨æˆ–å…¶ä»–åŸºæ–¼ JVM çš„æ‡‰ç”¨ä¸­é€²è¡Œæ—¥èªŒè¨˜éŒ„æ™‚ï¼Œlogback-classic å°±æ˜¯ä¸»è¦ä¾è³´ã€‚
2. logback-core (éå¿…è¦)
	ç”¨é€”ï¼šé€™æ˜¯ Logback çš„æ ¸å¿ƒæ¨¡çµ„ï¼Œlogback-classic å’Œ logback-access éƒ½ä¾è³´æ–¼å®ƒã€‚å®ƒå®šç¾©äº†æ—¥èªŒè¨˜éŒ„çš„åŸºç¤æ¶æ§‹å’Œå…ƒä»¶ï¼Œå¦‚ Appenderã€Layout ç­‰ã€‚
	é©ç”¨å ´æ™¯ï¼šä½ é€šå¸¸ä¸æœƒç›´æ¥åœ¨ä½ çš„å°ˆæ¡ˆä¸­åªä½¿ç”¨ logback-coreï¼Œå› ç‚ºå®ƒæ˜¯ logback-classic æˆ– logback-access çš„åº•å±¤ä¾è³´é …ã€‚é™¤éä½ æ‰“ç®—å¯¦ç¾è‡ªè¨‚çš„ Appenderã€Encoderã€Filter ç­‰ï¼Œå¦å‰‡ä½ ä¸éœ€è¦å–®ç¨ä¾è³´ logback-coreã€‚
3. logback-access
	ç”¨é€”ï¼šé€™å€‹æ¨¡çµ„ä¸»è¦ç”¨æ–¼ç¶²é ä¼ºæœå™¨ï¼ˆå¦‚ Tomcatã€Jettyï¼‰çš„ HTTP æ—¥èªŒè¨˜éŒ„ã€‚å®ƒå¯ä»¥è¨˜éŒ„ HTTP è«‹æ±‚/å›æ‡‰ï¼Œé¡ä¼¼æ–¼ Apache HTTP ä¼ºæœå™¨çš„ access.logã€‚
	é©ç”¨å ´æ™¯ï¼šå¦‚æœä½ æƒ³è¨˜éŒ„ Web æ‡‰ç”¨ä¼ºæœå™¨çš„è¨ªå•æ—¥èªŒï¼Œç‰¹åˆ¥æ˜¯ HTTP è«‹æ±‚çš„ç›¸é—œä¿¡æ¯ï¼ˆå¦‚ IP åœ°å€ã€è«‹æ±‚æ™‚é–“ã€HTTP ç‹€æ…‹ç¢¼ç­‰ï¼‰ï¼Œé‚£éº¼ä½ å¯ä»¥ä½¿ç”¨ logback-accessã€‚é€™ç¨®æƒ…æ³é€šå¸¸å‡ºç¾åœ¨éœ€è¦åˆ†æä¼ºæœå™¨æµé‡æˆ–é€²è¡Œ Web å®‰å…¨å¯©è¨ˆæ™‚

========================================================================================================================
=================================== log level ==========================================================================
========================================================================================================================
å±¤ç´šç”±å¤§åˆ°å°
	TRACE > DEBUG > INFO > WARN > ERROR
		if setting log level DEBUG
			print DEBUG > INFO > WARN > ERROR
		if setting log level WARN
			print WARN > ERROR
		....

========================================================================================================================
================================= <configuration> ======================================================================
========================================================================================================================
ä¸‰å€‹ä¸»è¦å±¬æ€§
	scanï¼šç•¶scanè¢«è¨­ç½®ç‚ºtrueæ™‚ï¼Œç•¶é…ç½®æ–‡ä»¶ç™¼ç”Ÿæ”¹è®Šï¼Œå°‡æœƒè¢«é‡æ–°åŠ è¼‰ï¼Œé»˜èªç‚ºtrue
	scanPeriodï¼šæª¢æ¸¬é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ™‚é–“é–“éš”ï¼Œå¦‚æœæ²’æœ‰çµ¦å‡ºæ™‚é–“å–®ä½ï¼Œé»˜èªç‚ºæ¯«ç§’ï¼Œç•¶scan=trueæ™‚é€™å€‹å€¼ç”Ÿæ•ˆï¼Œé»˜èªæ™‚é–“é–“éš”ç‚º1åˆ†é˜
	debugï¼šç•¶è¢«è¨­ç½®ç‚ºtrueæ™‚ï¼Œå°‡æ‰“å°å‡ºlogbackå…§éƒ¨æ—¥èªŒä¿¡æ¯ï¼Œå¯¦æ™‚æŸ¥çœ‹logbacké‹è¡Œä¿¡æ¯ï¼Œé»˜èªç‚ºfalse

auto reload in prod
	<configuration scan="true" scanPeriod="15 seconds">
	  ...
	</configuration>

========================================================================================================================
================================= <logger>èˆ‡<root> =====================================================================
========================================================================================================================
<logger>
	ç”¨ä¾†è¨­ç½®æŸä¸€å€‹åŒ…æˆ–è€…ä¿±é«”æŸä¸€å€‹é¡çš„æ—¥èªŒæ‰“å°ç´šåˆ¥ã€ä»¥åŠæŒ‡å®š<appender>ã€‚
	<logger>å¯ä»¥åŒ…å«é›¶å€‹æˆ–è€…å¤šå€‹<appender-ref>å…ƒç´ ï¼Œæ¨™è­˜é€™å€‹appenderå°‡æœƒæ·»åŠ åˆ°é€™å€‹loggerã€‚
	<logger>åƒ…æœ‰ä¸€å€‹nameå±¬æ€§ã€ä¸€å€‹å¯é¸çš„levelå±¬æ€§å’Œä¸€å€‹å¯é¸çš„additivityå±¬æ€§ï¼š

	nameï¼šç”¨ä¾†æŒ‡å®šå—æ­¤loggerç´„æŸçš„æŸä¸€å€‹åŒ…æˆ–è€…ä¿±é«”çš„æŸä¸€å€‹é¡
	levelï¼šç”¨ä¾†è¨­ç½®æ‰“å°ç´šåˆ¥ï¼Œäº”å€‹å¸¸ç”¨æ‰“å°ç´šåˆ¥å¾ä½è‡³é«˜ä¾æ¬¡ç‚º TRACEã€DEBUGã€INFOã€WARNã€ERRORï¼Œå¦‚æœæœªè¨­ç½®æ­¤ç´šåˆ¥ï¼Œé‚£éº¼ç•¶å‰loggeræœƒç¹¼æ‰¿ä¸Šç´šçš„ç´šåˆ¥
	additivityï¼šæ˜¯å¦å‘ä¸Šç´šloggerå‚³éæ‰“å°ä¿¡æ¯ï¼Œé»˜èªç‚ºtrue

<root>
	1.ä¹Ÿæ˜¯<logger>å…ƒç´ ï¼Œä½†æ˜¯å®ƒæ˜¯æ ¹loggerï¼Œåªæœ‰ä¸€å€‹levelå±¬æ€§ï¼Œå› ç‚ºå®ƒçš„nameå°±æ˜¯ROOT
    2.åªå½±éŸ¿æ²’æœ‰æ˜ç¢ºå®£å‘Šç­‰ç´šçš„ <logger> ä¹‹ package è·¯å¾‘ï¼Œä¹Ÿå°±é è¨­å€¼çš„ log level
	3.Actuator /actuator/loggers/{name}
		* æœƒåŒæ™‚é¡¯ç¤º configuredLevelï¼ˆç›´æ¥è¨­å®šçš„å€¼ï¼Œå¯èƒ½ä¾†è‡ª XML/å±¬æ€§/é‹è¡Œæ™‚è®Šæ›´ï¼‰èˆ‡ effectiveLevelï¼ˆå¯¦éš›ç”Ÿæ•ˆï¼Œæœƒè€ƒæ…®ç¹¼æ‰¿ï¼‰ã€‚
		* è‹¥çœ‹åˆ° configuredLevel=null è€Œ effectiveLevel=DEBUGï¼Œä»£è¡¨å®ƒæ˜¯ç¹¼æ‰¿ä¾†çš„ï¼ˆä¾‹å¦‚ç¹¼æ‰¿ root=DEBUGï¼‰ï¼›è‹¥ configuredLevel=ERRORï¼Œå°±ä¸æœƒè¢« root çš„ DEBUG è¦†è“‹ã€‚

æŒ‡å®šéƒ¨åˆ† java package log level
	<logger name="tw.gov.moi" level="DEBUG" />

<root> è¨­å®šåŸºæœ¬ levelï¼ŒæŒ‡å®šé‚£äº› appender-ref ref="OTHER-APPENDER" æ²¿ç”¨
	<root level="DEBUG">
		<if condition='property("stdout.enable")'.contains("Y")><then><appender-ref ref="STDOUT"></then></if>
		<appender-ref ref="FILE-ROLL">
	</root>

========================================================================================================================
================================= Variable Substitution ================================================================
========================================================================================================================

Variable Substitution
	<property name="LOG_DIR" value="/var/log/application" />
	<appender name="FILE" class="ch.qos.logback.core.FileAppender">
		<file>${LOG_DIR}/tests.log</file>
		<append>true</append>
		<encoder>
			<pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>
		</encoder>
	</appender>

========================================================================================================================
================================= Appender =============================================================================
========================================================================================================================
https://logback.qos.ch/manual/appenders.html

ConsoleAppender
	<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
		</encoder>
	</appender>

	<root level="debug">
		<appender-ref ref="STDOUT" />
	</root>

FileAppender
    <appender name="FILE" class="ch.qos.logback.core.FileAppender">
        <file>tests.log</file>
        <append>true</append>
        <encoder>
            <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>
        </encoder>
    </appender>
	<logger name="com.baeldung.logback.tests" level="WARN">
        <appender-ref ref="FILE" />
    </logger>

RollingFileAppender
	<property name="LOG_FILE" value="LogFile" />

	<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${LOG_FILE}.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<!-- daily rollover -->
			<fileNamePattern>${LOG_FILE}.%d{yyyy-MM-dd}.gz</fileNamePattern>

			<!-- keep 30 days' worth of history capped at 3GB total size -->
			<maxHistory>30</maxHistory>
			<totalSizeCap>3GB</totalSizeCap>
		</rollingPolicy>
		<encoder>
			<pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>
		</encoder>
	</appender>

Appender éæ¿¾å™¨ <filter> ç”¨æ–¼éæ¿¾æ—¥èªŒç­‰ç´š
	ThresholdFilter
		* ç”¨é€”ï¼šæŒ‡å®šä¸€å€‹ã€Œæœ€ä½ç­‰ç´šé–¾å€¼ã€ï¼Œåªæœ‰ å¤§æ–¼ç­‰æ–¼è©²ç­‰ç´š çš„ log event æœƒè¢«æ¥å—ã€‚
		* èªæ³•ç¯„ä¾‹ï¼š
			<filter class="ch.qos.logback.classic.filter.ThresholdFilter">
			  <level>WARN</level>
			</filter>
			â†’ é€™æ¨£ä»£è¡¨ WARNã€ERROR éƒ½æœƒé€²ä¾†ï¼ŒINFOã€DEBUG æœƒè¢«ä¸Ÿæ‰ã€‚
		* ç‰¹é»ï¼š
			* åªéœ€è¦è¨­å®š <level>ï¼ˆæ²’æœ‰ onMatch / onMismatchï¼‰ã€‚
			* ç°¡å–®å¥½ç”¨ï¼Œé©åˆã€Œåªè¦æ”¶æŸå€‹ç­‰ç´šä»¥ä¸Šçš„æ‰€æœ‰ logã€ã€‚
	LevelFilter
		* ç”¨é€”ï¼šåªé‡å°ã€Œç­‰æ–¼æŸä¸€å€‹ç­‰ç´šã€çš„ log event åˆ¤æ–·ã€‚
		* èªæ³•ç¯„ä¾‹ï¼š
			<filter class="ch.qos.logback.classic.filter.LevelFilter">
			  <level>ERROR</level>
			  <onMatch>ACCEPT</onMatch>
			  <onMismatch>DENY</onMismatch>
			</filter>
			â†’ é€™æ¨£ä»£è¡¨åªæœ‰ ERROR ç­‰ç´šçš„ log æœƒé€²ä¾†ï¼Œå…¶ä»–å…¨éƒ¨ä¸Ÿæ‰ã€‚
		* ç‰¹é»ï¼š
			* éœ€è¦è¨­å®š <onMatch> èˆ‡ <onMismatch>ã€‚
			* é©åˆã€Œåªè¦æŸä¸€å€‹ç²¾ç¢ºç­‰ç´šã€çš„éœ€æ±‚ï¼Œä¾‹å¦‚ error.log åªæ”¶ ERRORï¼Œä¸æ”¶ WARNã€‚
	ğŸ”¹ å¯¦å‹™å»ºè­°
		ä¸€èˆ¬ä¸»æª”æ¡ˆï¼ˆæ‡‰ç”¨ logï¼‰ â†’ ç”¨ ThresholdFilterï¼ˆä¾‹å¦‚ INFO ä»¥ä¸Šéƒ½æ”¶ï¼‰ã€‚
		åˆ†æµæª”æ¡ˆï¼ˆerror.log / warn.logï¼‰ â†’ ç”¨ LevelFilterï¼ˆåªæ”¶ç‰¹å®šç´šåˆ¥ï¼‰ã€‚


å…¶ä»–å¸¸è¦‹å¯ç”¨ Appender
	SocketAppender
	SSLSocketAppender
	SMTPAppender
	DBAppender
	SyslogAppender
	SiftingAppender
	AsyncAppender

å…¶ä»–å¸¸è¦‹å¯ç”¨ Policy
	TimeBasedRollingPolicy
	SizeBasedTriggeringPolicy
	SizeAndTimeBasedRollingPolicy
	FixedWindowRollingPolicy

========================================================================================================================
================================= Layouts =============================================================================
========================================================================================================================

	<encoder>
		<pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
	</encoder>

	%d{HH:mm:ss.SSS} â€“ a timestamp with hours, minutes, seconds and milliseconds
	[%thread] â€“ the thread name generating the log message, surrounded by square brackets
	%-5level â€“ the level of the logging event, padded to 5 characters
	%logger{36} â€“ the name of the logger, truncated to 35 characters
	%msg%n â€“ the log messages followed by the platform dependent line separator character

	%d{yyyy-MM-dd HH:mm:ss.SSS}ï¼šè¼¸å‡ºæ—¥èªŒçš„æ™‚é–“æˆ³ï¼Œæ ¼å¼ç‚º å¹´-æœˆ-æ—¥ å°æ™‚:åˆ†é˜:ç§’.æ¯«ç§’ã€‚
	%pï¼šè¼¸å‡ºæ—¥èªŒçš„å„ªå…ˆç´šï¼Œä¾‹å¦‚ DEBUGã€INFOã€WARNã€ERROR ç­‰ã€‚
	%tï¼šè¼¸å‡ºåŸ·è¡Œç·’çš„åç¨±ã€‚
	%cï¼šè¼¸å‡ºæ—¥èªŒçš„é¡åˆ¥åç¨±ã€‚
	%mï¼šè¼¸å‡ºæ—¥èªŒçš„å…§å®¹ã€‚
	%nï¼šè¼¸å‡ºä¸€å€‹æ–°è¡Œã€‚

========================================================================================================================
================================= additivity ===========================================================================
========================================================================================================================

additivity :
	å¯åŠ æ€§ï¼Œé è¨­ true
	ç•¶ç‚º false : ä¸å¸Œæœ›åœ¨æŸäº›å ´æ™¯ä¸‹åˆ—å°é‡è¤‡çš„ç´€éŒ„æª”ï¼Œä¸å— level è¨­å®šçš„å½±éŸ¿ï¼Œé€šå¸¸æ­é…æ–¼ç¨ç«‹ log
	æŒ‡å®šé‚£äº› <logger> ä¹‹ appender-ref ä¸æ²¿ç”¨ <root>
		<logger name="PROFILER" level="TRACE" additivity="false"><appender-ref ref="FILE-ROLL-PROFILER"><logger/>
		...

	https://github.dev/qos-ch/logback/blob/master/logback-classic/src/main/java/ch/qos/logback/classic/Logger.java
    /**
     * Invoke all the appenders of this logger.
     *
     * @param event The event to log
     */
    public void callAppenders(ILoggingEvent event) {
        int writes = 0;
        for (Logger l = this; l != null; l = l.parent) {
            writes += l.appendLoopOnAppenders(event);
            if (!l.additive) {
                break;
            }
        }
        // No appenders in hierarchy
        if (writes == 0) {
            loggerContext.noAppenderDefinedWarning(this);
        }
    }

ç¨ç«‹ log ç¯„ä¾‹
	https://blog.csdn.net/qq_44209563/article/details/123697183

========================================================================================================================
================================= MDC ==================================================================================
========================================================================================================================
https://www.baeldung.com/mdc-in-log4j-2-logback

åªéœ€è¦æ¸…é™¤ MDC ä¸­çš„æŸä¸ªç‰¹å®šé”®ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ MDC.remove(key) æ–¹æ³•ã€‚
å¦‚æœéœ€è¦æ¸…é™¤ MDC ä¸­çš„æ‰€æœ‰é”®å’Œå€¼ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ MDC.clear() æ–¹æ³•ã€‚

ä½¿ç”¨éæ¿¾å™¨é‚„æ˜¯æ””æˆªå™¨ï¼Œåœ¨è«‹æ±‚çµæŸæ™‚æ¸…é™¤ MDC éƒ½æ˜¯ä¸€ç¨®æœ€ä½³å¯¦è¸ï¼Œä»¥ç¢ºä¿è«‹æ±‚ä¹‹é–“ä¸æœƒå¹²æ“¾ä¸¦ä¿æŒ MDC çš„æº–ç¢ºæ€§