ref ChatGPT
	https://docs.spring.io/spring-cloud-gateway/reference/spring-cloud-gateway-server-webmvc.html

WebMVC Gateway(æ”¯æ´ spring mvc çš„ gateway)

1.maven ä¾è³´
	<dependency>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-oauth2-resource-server</artifactId>
	</dependency>
	<dependency>
		<groupId>org.springframework.cloud</groupId>
		<artifactId>spring-cloud-starter-gateway-server-webmvc</artifactId>
	</dependency>

2.application.yml
	server:
	  port: 8080

	spring:
	  application:
		name: api-gateway

	  cloud:
		gateway:
		  default-filters:
			- TokenRelay
		  routes:
			- id: backend-service
			  uri: lb://backend-service   # ä½¿ç”¨æœå‹™ç™¼ç¾
			  predicates:
				- Path=/api/backend/**
			  filters:
				- StripPrefix=1

	  security:
		oauth2:
		  resourceserver:
			jwt:
			  issuer-uri: https://your-auth-server.com  # æ ¹æ“šä½ çš„ Auth Server è¨­å®š

	eureka:
	  client:
		service-url:
		  defaultZone: http://localhost:8761/eureka/


3.java
	configuration

		@Configuration
		@EnableWebSecurity
		public class SecurityConfig {

			@Bean
			SecurityFilterChain securityFilterChain(final HttpSecurity http) throws Exception {
				http.authorizeHttpRequests(authz -> authz //
						.anyRequest().authenticated() // åªé©— JWT æœ‰æ•ˆæ€§ï¼Œä¸é©— scope
				);
				http.oauth2ResourceServer(oauth2 -> oauth2 //
						.jwt() // ä½¿ç”¨ Resource Server å…§å»º JWT é©—è­‰
				);
				return http.build();
			}
		}

ğŸ”š Gateway è™•ç†å°çµ
	| åŠŸèƒ½           | æ˜¯å¦éœ€è¦è‡ªå¯«                                 |
	| -------------- | -------------------------------------------- |
	| JWT é©—ç°½       | âŒ ä¸ç”¨ï¼Œè‡ªå‹•è™•ç†                            |
	| ä¸é©— scope     | âœ… é è¨­å°±ä¸é©—ï¼Œé™¤éä½ å¯« `.hasAuthority(...)` |
	| æ“´å…… JWT claim | âœ… å¯ç”¨ `SecurityContextHolder` å–å¾—         |


å”¯ä¸€ä½ å¯èƒ½ã€Œè¦å¯« Javaã€çš„æƒ…æ³ï¼š
	| ç›®çš„                                  | æ˜¯å¦è¦å¯« Java                     |
	| ------------------------------------- | --------------------------------- |
	| å®¢è£½é©—è­‰è¦å‰‡ï¼ˆä¾‹å¦‚é™åˆ¶ IPï¼‰           | âœ… è¦è‡ªå·±åŠ  Filter/Interceptor    |
	| è½‰ç™¼æ™‚ä¿ç•™ Headerï¼ˆå¦‚ Authorizationï¼‰ | âœ… è‹¥éè‡ªå‹•å‚³éï¼Œè¦æ‰‹å‹•åŠ          |
	| MDC æˆ– Logging å¼·åŒ–                   | âœ… å»ºè­°åŠ                          |
	| å¾®èª¿ SecurityFilterChain              | âœ… å»ºè­°åŠ ï¼ˆå¯é¸ï¼‰                 |


éŒ¯èª¤è™•ç†
	| éŒ¯èª¤é¡å‹               | æ˜¯å¦å¯æ””æˆªçµ±ä¸€è™•ç† | å‚™è¨»                                       |
	| ---------------------- | ------------------ | ------------------------------------------ |
	| JWT ç„¡æ•ˆ / éºå¤±        | âœ…                 | è¢« Spring Security æ””ä¸‹ï¼Œèµ° `/error`       |
	| å¾Œç«¯æœå‹™å›å‚³ 5xx       | âœ…                 | å¯çµ±ä¸€æ ¼å¼åŒ…è£                             |
	| å¾Œç«¯æœå‹™æ›æ‰ / ç„¡å¯¦ä¾‹  | âœ…                 | Eureka æ‰¾ä¸åˆ°æœå‹™ä¹Ÿæœƒèµ° Exception          |
	| DNS å•é¡Œ / é€£ç·šå¤±æ•—    | âŒï¼ˆç‰¹æ®Šæƒ…æ³ï¼‰     | è‹¥å¤ªæ—©å¤±æ•—ï¼Œå¯èƒ½èµ°ä¸åˆ° DispatcherServlet   |
