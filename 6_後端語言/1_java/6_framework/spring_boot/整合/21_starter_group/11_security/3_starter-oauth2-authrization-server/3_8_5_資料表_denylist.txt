æ—‹è½‰ç­–ç•¥è¡¨ï¼šoauth2aj003 : jwk_denylist
	1. æœ€ç°¡å–®ç‰ˆï¼šåªå­˜ kid
		CREATE TABLE jwk_denylist (
			id          BIGINT IDENTITY(1,1) PRIMARY KEY,
			issuer      NVARCHAR(200) NOT NULL,       -- å“ªå€‹ Auth Server çš„é‡‘é‘°
			kid         NVARCHAR(128) NOT NULL,       -- JWK çš„ Key ID
			reason      NVARCHAR(200) NULL,           -- å°é–åŸå›  (compromised, retired, manual)
			created_at  DATETIME2 NOT NULL DEFAULT SYSUTCDATETIME(),
			expires_at  DATETIME2 NULL                -- å¯é¸ï¼Œå°é–æœŸé™ (e.g. grace éå¾Œè‡ªå‹•æ¸…æ‰)
		);
		CREATE INDEX IX_jwk_denylist_issuer_kid ON jwk_denylist(issuer, kid);

		ğŸ‘‰ é€™å€‹è¨­è¨ˆå°±æ˜¯å°æ‡‰ä½  inMemory repo çš„ã€Œå°é– kidã€ç‰ˆæœ¬ã€‚

	2. æ“´å……ç‰ˆï¼šå°é– Token (jti)
		å¦‚æœä½ è¦ç²¾ç´°åˆ° å€‹åˆ¥ JWT Token è¢«æ’¤éŠ·ï¼ˆä¾‹å¦‚ user logoutã€token é»‘åå–®ï¼‰ï¼Œéœ€è¦åŠ ä¸Š token çš„ jtiï¼ˆJWT IDï¼‰ã€‚
		CREATE TABLE token_denylist (
			id          BIGINT IDENTITY(1,1) PRIMARY KEY,
			issuer      NVARCHAR(200) NOT NULL,       -- å“ªå€‹ Auth Server
			jti         NVARCHAR(128) NOT NULL,       -- JWT çš„å”¯ä¸€è­˜åˆ¥ (token è£¡çš„ jti)
			subject     NVARCHAR(200) NULL,           -- å¯é¸ï¼Œç”¨ä¾†è¿½æŸ¥ (sub claim)
			reason      NVARCHAR(200) NULL,           -- å°é–åŸå› 
			created_at  DATETIME2 NOT NULL DEFAULT SYSUTCDATETIME(),
			expires_at  DATETIME2 NOT NULL
		);
		CREATE INDEX IX_token_denylist_issuer_jti ON token_denylist(issuer, jti);

		ğŸ‘‰ é€™æœƒè¢«ç”¨åœ¨ logout / refresh token revoke çš„å ´æ™¯ã€‚

	3. æ··åˆç‰ˆï¼šåŒæ™‚æ”¯æ´ kid + jti
		æœ‰äº›ç³»çµ±æœƒæ”¾ä¸€èµ·ï¼Œå› ç‚ºæœ‰æ™‚å€™è¦å°é–æŸæŠŠé‡‘é‘°ï¼Œæœ‰æ™‚å€™è¦å°é–å–®ä¸€ tokenã€‚
		CREATE TABLE jwk_denylist (
			id          BIGINT IDENTITY(1,1) PRIMARY KEY,
			issuer      NVARCHAR(200) NOT NULL,
			kid         NVARCHAR(128) NULL,           -- å°é–æŸæŠŠé‡‘é‘°æ™‚å¡«
			jti         NVARCHAR(128) NULL,           -- å°é–æŸå€‹ token æ™‚å¡«
			subject     NVARCHAR(200) NULL,			  -- å°é–æŸå€‹ token : å¯é¸ï¼Œç”¨ä¾†è¿½æŸ¥ (sub claim)
			reason      NVARCHAR(200) NULL,			  -- å°é–åŸå›  (compromised, retired, manual)
			created_at  DATETIME2 NOT NULL DEFAULT SYSUTCDATETIME(),
			expires_at  DATETIME2 NULL
		);
		CREATE INDEX IX_jwk_denylist_issuer_kid ON jwk_denylist(issuer, kid) WHERE kid IS NOT NULL;
		CREATE INDEX IX_jwk_denylist_issuer_jti ON jwk_denylist(issuer, jti) WHERE jti IS NOT NULL;

ğŸ“Œ å»ºè­°

	å¦‚æœä½ ç›®å‰çš„ inMemory repo åªæ˜¯é‡å° JWK Key rotation æ™‚ï¼Œå°é–æŸæŠŠé‡‘é‘° (kid) â†’ é¸ æ–¹æ¡ˆ 1ã€‚

	å¦‚æœä½ é‚„è¦æ”¯æ´ å–®ä¸€ Token æ’¤éŠ· (logout, refresh token revoke) â†’ è¦ æ–¹æ¡ˆ 2 æˆ– æ–¹æ¡ˆ 3ã€‚

	æ¬„ä½ expires_at å¾ˆé‡è¦ï¼Œå› ç‚º token æœ¬èº«æœ‰ TTLï¼ŒéæœŸå¾Œé»‘åå–®å¯ä»¥è‡ªå‹•æ¸…ç†ï¼Œé¿å…è¡¨å¤ªå¤§ã€‚