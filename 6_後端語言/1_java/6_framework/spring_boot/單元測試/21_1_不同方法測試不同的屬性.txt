ref ChatGPT

ä¸åŒæ–¹æ³•æ¸¬è©¦ä¸åŒçš„å±¬æ€§
	æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ TestPropertySource æ­é… @Nested
	æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ System.setProperty æ­é… @BeforeEach
	æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ @ContextConfiguration é‡å°ç‰¹å®šæ¸¬è©¦é‡æ–°è¼‰å…¥ Spring Context

	ä½¿ç”¨ TestPropertySource æ­é… @Nested
		@SpringBootTest
		public class MyServiceTest {

			@Nested
			@TestPropertySource(properties = "my.property=value1")
			class Case1 {
				@Test
				void test1() {
					assertEquals("value1", System.getProperty("my.property"));
				}
			}

			@Nested
			@TestPropertySource(properties = "my.property=value2")
			class Case2 {
				@Test
				void test2() {
					assertEquals("value2", System.getProperty("my.property"));
				}
			}
		}
		ğŸ“Œ å„ªé»ï¼šä¸åŒæ¸¬è©¦å€å¡Šä½¿ç”¨ä¸åŒçš„ TestPropertySourceã€‚
		ğŸ“Œ ç¼ºé»ï¼šæ¸¬è©¦æ–¹æ³•ä¸èƒ½åœ¨åŒä¸€å€‹é¡åˆ¥å…§ç›´æ¥æ··ç”¨ä¸åŒå±¬æ€§ã€‚
	
	ä½¿ç”¨ System.setProperty æ­é… @BeforeEach
		@SpringBootTest
		public class MyServiceTest {

			@Autowired
			private Environment environment;

			@BeforeEach
			void setup(TestInfo testInfo) {
				if (testInfo.getTestMethod().get().getName().equals("test1")) {
					System.setProperty("my.property", "value1");
				} else {
					System.setProperty("my.property", "value2");
				}
			}

			@Test
			void test1() {
				assertEquals("value1", environment.getProperty("my.property"));
			}

			@Test
			void test2() {
				assertEquals("value2", environment.getProperty("my.property"));
			}
		}
		ğŸ“Œ å„ªé»ï¼š
			å¯ä»¥é‡å°ä¸åŒæ¸¬è©¦æ–¹æ³•è¨­å®šä¸åŒçš„ System.setPropertyã€‚
		ğŸ“Œ ç¼ºé»ï¼š
			System.setProperty å½±éŸ¿ å…¨åŸŸï¼Œå¯èƒ½æœƒå½±éŸ¿åˆ°å…¶ä»–æ¸¬è©¦ã€‚
			Spring çš„ Environment è®€å–ç³»çµ±å±¬æ€§å¯èƒ½ä¸æœƒå³æ™‚ç”Ÿæ•ˆã€‚
	
	ä½¿ç”¨ @ContextConfiguration é‡å°ç‰¹å®šæ¸¬è©¦é‡æ–°è¼‰å…¥ Spring Context
		å¦‚æœä½ é¡˜æ„è®“ Spring é‡æ–°è¼‰å…¥ ApplicationContextï¼Œå¯ä»¥ä½¿ç”¨ï¼š
			@ContextConfiguration(initializers = CustomInitializer.class)
		ç„¶å¾Œåœ¨ CustomInitializer è¨­å®šä¸åŒçš„å±¬æ€§ï¼š
			public class CustomInitializer implements ApplicationContextInitializer<ConfigurableApplicationContext> {

				@Override
				public void initialize(ConfigurableApplicationContext context) {
					TestPropertyValues.of("my.property=value1").applyTo(context.getEnvironment());
				}
			}
		ğŸ“Œ å„ªé»ï¼š
			ç¢ºä¿å±¬æ€§è®Šæ›´èƒ½å¤ å½±éŸ¿ Spring ç’°å¢ƒã€‚
		ğŸ“Œ ç¼ºé»ï¼š
			Context éœ€è¦é‡æ–°è¼‰å…¥ï¼Œå¯èƒ½å°è‡´æ¸¬è©¦åŸ·è¡Œè®Šæ…¢ã€‚