æ¦‚è¦
	Java çš„ record èªæ³• æ˜¯åœ¨ Java 14 (2020 å¹´ 3 æœˆ) é¦–æ¬¡å¼•å…¥ï¼Œä½œç‚º Preview Feature (é è¦½åŠŸèƒ½)ï¼Œéœ€è¦åœ¨ç·¨è­¯èˆ‡åŸ·è¡Œæ™‚åŠ ä¸Š --enable-preview æ‰èƒ½ä½¿ç”¨ã€‚

	å¾ŒçºŒç‰ˆæœ¬ç‹€æ…‹ï¼š
		Java 14ã€15ï¼šPreview (é è¦½åŠŸèƒ½)ã€‚
		Java 16 (2021 å¹´ 3 æœˆ)ï¼šæ­£å¼æˆç‚º æ¨™æº–åŠŸèƒ½ (GA)ï¼Œä¸éœ€è¦ --enable-previewã€‚

		æ‰€ä»¥ï¼š
			ğŸ‘‰ Java 16 èµ·ï¼Œrecord å¯ä»¥æ­£å¼ä½¿ç”¨ã€‚

	record çš„ç”¨é€”
		record æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„ è³‡æ–™é¡å‹ (data carrier)ï¼Œä¸»è¦ç”¨ä¾†å®šç¾©åªç”¨ä¾†æ‰¿è¼‰è³‡æ–™ã€
		ä¸éœ€è¦å¤ªå¤šæ¨£æ¿ç¨‹å¼ç¢¼ (boilerplate) çš„é¡åˆ¥ã€‚

é©åˆçš„æƒ…å¢ƒï¼š
	1.ä¸å¯è®Šè³‡æ–™ (Immutable Data)
		* é è¨­æ¬„ä½æ˜¯ finalï¼Œç‰©ä»¶å»ºç«‹å¾Œç„¡æ³•ä¿®æ”¹ã€‚
		* é©åˆç”¨æ–¼å‚³éè³‡æ–™ã€DTO (Data Transfer Object)ã€äº‹ä»¶æ¨¡å‹ç­‰ã€‚
			public record User(String id, String name, int age) {}
		
	2.ä»£æ›¿ JavaBean / DTO
		* ä¸éœ€è¦è‡ªå·±å¯« getterã€equals()ã€hashCode()ã€toString()ã€‚
		* ç·¨è­¯å™¨è‡ªå‹•ç”¢ç”Ÿã€‚
			User u = new User("u01", "David", 30);
			System.out.println(u.name()); // getter è‡ªå‹•æœ‰

	3.å€¼å° (Value Objects)
		* é©åˆç”¨æ–¼åªéœ€æ‰¿è¼‰å€¼ã€ä¸éœ€è¦é‚è¼¯çš„æ–¹æ³•ï¼Œä¾‹å¦‚ (x, y)ã€Range(min, max)ã€‚
	
	4.Pattern Matching / Switch æ•´åˆ
		* åœ¨ Java 17+ æ­é… Pattern Matching for switch æ›´ç›´è¦ºã€‚
			sealed interface Shape permits Circle, Rectangle {}
			record Circle(double radius) implements Shape {}
			record Rectangle(double width, double height) implements Shape {}

			static double area(Shape shape) {
				return switch (shape) {
					case Circle c -> Math.PI * c.radius() * c.radius();
					case Rectangle r -> r.width() * r.height();
				};
			}
	
	5.å–ä»£éƒ¨åˆ† Lombok @Data ç”¨ä¾‹
		* å¦‚æœåªéœ€è¦ç°¡å–®çš„è³‡æ–™æ‰¿è¼‰ï¼Œrecord æ¯”è¼ƒä¹¾æ·¨ï¼Œä¸éœ€è¦é¡å¤–çš„ annotation processorã€‚


æ ¼å¼
	public record User(String id, String name, int age) {
		// ä½ å¯ä»¥é¡å¤–å¯«æ–¹æ³•ï¼Œä½†ä¸èƒ½æœ‰é static æ¬„ä½
		public String displayName() {
			return name + " (" + id + ")";
		}
	}

ç‰¹é»ï¼š
	è‡ªå‹•ç”Ÿæˆï¼š
		* private final æ¬„ä½
		* å»ºæ§‹å­ (canonical constructor)
		* Getterï¼ˆç”¨æ–¹æ³•åç›´æ¥å–å€¼ï¼Œä¸æ˜¯ getXxx()ï¼Œè€Œæ˜¯ xxx()ï¼‰
		* equals()ã€hashCode()ã€toString()

record vs Bean å·®ç•°è¡¨
	| ç‰¹æ€§                       | å‚³çµ± Bean      | Lombok @Data | `record`         |
	| ------------------------ | ------------ | ------------ | ---------------- |
	| æ¬„ä½                       | mutable (å¯æ”¹) | å¯é¸ `final`   | é è¨­ `final` (ä¸å¯è®Š) |
	| Getter                   | `getXxx()`   | `getXxx()`   | `xxx()`          |
	| Setter                   | æœ‰/éœ€æ‰‹å¯«        | è‡ªå‹•ç”Ÿæˆ         | âŒ ä¸å…è¨±            |
	| equals/hashCode/toString | éœ€æ‰‹å¯«/IDE      | è‡ªå‹•ç”Ÿæˆ         | è‡ªå‹•ç”Ÿæˆ             |
	| å»ºæ§‹å­                      | éœ€æ‰‹å¯«          | è‡ªå‹•ç”Ÿæˆ         | è‡ªå‹•ç”Ÿæˆ (canonical) |
	| ä¸å¯è®Šæ€§                     | âŒ            | å¯é¸           | âœ… é è¨­             |
	| èªæ³•ç²¾ç°¡                     | âŒ            | âœ…            | âœ…ï¼ˆæ›´å…§å»ºï¼‰           |

é©åˆã€Œåªæƒ³å­˜è³‡æ–™ï¼Œä¸æƒ³æ”¹è³‡æ–™ã€çš„å ´åˆï¼Œåƒæ˜¯ï¼š
	DTO / API å›å‚³ç‰©ä»¶
		Event / Message ç‰©ä»¶
		å€¼ç‰©ä»¶ (Value Object, e.g. Point(x, y))


æ¨è–¦çš„ä½¿ç”¨æ–¹å¼
	1) Spring Data JPA æŠ•å½± (Projection) å›å‚³ record
		ç¯„ä¾‹ï¼šclass-based projectionï¼ˆJPQL constructor expressionï¼‰
			// DTO / Projection
			public record UserSummary(Long id, String name) {}

			public interface UserRepository extends JpaRepository<User, Long> {

				@Query("""
					   select new com.example.dto.UserSummary(u.id, u.name)
					   from User u
					   where u.status = :status
					   """)
				List<UserSummary> findAllByStatus(@Param("status") Status status);
			}
			select new ... åªè¦åƒæ•¸é †åºèˆ‡ record çš„ canonical constructor ä¸€è‡´å³å¯ã€‚
		
		æˆ–ï¼šæ–¹æ³•å›å‚³å‹åˆ¥ç›´æ¥æ˜¯ recordï¼ˆéƒ¨åˆ†æƒ…å¢ƒï¼‰
			public record UserNameOnly(String name) {}

			List<UserNameOnly> findByAgeGreaterThan(int age);
			
			Spring Data æœƒå˜—è©¦ç”¨æŠ•å½±å»ºç«‹çµæœï¼›è‹¥å‘½åæ¨æ–·ä¸å¤ ï¼Œç”¨ @Query æœ€ç©©ã€‚
	
	2) REST DTO / API é‚Šç•Œç‰©ä»¶
		// Request DTO
		public record CreateUserCmd(String name, int age) {}

		// Response DTO
		public record UserView(Long id, String name, int age) {}
		
		* Jackson 2.12+ åŸç”Ÿæ”¯æ´ recordï¼ŒSpring Boot 2.6+ å¹¾ä¹é–‹ç®±å³ç”¨ã€‚

		* å„ªé»ï¼šä¸å¯è®Šã€å¯è®€æ€§é«˜ã€ç„¡æ¨£æ¿ç¨‹å¼ç¢¼ã€‚
	
	3) Domain Event / Message Payload
		public record UserCreatedEvent(Long id, String name, Instant occurredAt) {}
		* ä¸² Kafka / RabbitMQ ç•¶ payload å¾ˆé©åˆï¼ˆç©©å®šä¸å¯è®Šï¼‰ã€‚
	
	4) æŸ¥è©¢æ¨¡å‹ï¼ˆCQRS è®€å´ï¼‰
		* å¯«å…¥å´ç”¨ Entityï¼›è®€å´ç”¨ record æ­é…æŠ•å½±æŸ¥è©¢ï¼Œé¿å…æŠŠæ•´å€‹ Entity æ‹‰å‡ºä¾†ï¼ˆå°¤å…¶é—œè¯å¾ˆæ·±æ™‚ï¼‰ã€‚

	Entity â†” DTO/Record çš„è½‰æ›
		å°å‹å°ˆæ¡ˆï¼šæ‰‹å¯« mappingï¼ˆå»ºæ§‹ new Dto(e.getId(), e.getName(), ...)ï¼‰ã€‚
		ä¸­å¤§å‹ï¼šç”¨ MapStruct ç”¢ç”Ÿ mapperï¼›æˆ–ç›´æ¥ç”¨ JPQL select new è®“ DB çµ„è£å¥½ DTOï¼ˆæ•ˆèƒ½æ›´ä½³ï¼Œå°‘ä¸€æ¬¡æ˜ å°„ï¼‰ã€‚

å°å¿ƒäº‹é …
	* æ‡¶åŠ è¼‰æ¬„ä½ï¼šç”¨æŠ•å½±æ™‚ç›¡é‡åªé¸ä½ è¦çš„æ¬„ä½ï¼Œé¿å…è§¸ç™¼ N+1ã€‚
	* record çš„ equals/hashCode`ï¼šä»¥æ‰€æœ‰ component å€¼ç‚ºæº–ã€‚ç•¶æˆç´”è³‡æ–™è¼‰é«” OKï¼Œä¸è¦æŠŠå®ƒèª¤ç”¨ç‚º Entity èº«åˆ†æ¨¡å‹ã€‚
	* é›™å‘é—œè¯ï¼šDTO/record è£¡é€šå¸¸ä¸è¦æ”¾æ•´å€‹é—œè¯ç‰©ä»¶ï¼ˆé¿å…åºåˆ—åŒ–éè¿´ï¼‰ï¼›åªæ”¾ id æˆ–å¿…è¦çš„æ‰å¹³æ¬„ä½ã€‚

ç¸½çµ
	âœ… Entityï¼šç¶­æŒå‚³çµ±å¯ç”¨æ–¼ JPA çš„ classï¼ˆå¯ no-argsã€å¯ field accessï¼‰ã€‚
	âœ… recordï¼šç”¨åœ¨ DTO / Projection / Event / Value Object / è®€å´ã€‚
	âœ… æ•ˆèƒ½èˆ‡ç¶­è­·æ€§ï¼šå„ªå…ˆç”¨ JPQL constructor expression æˆ– Spring Data æŠ•å½±ï¼Œç›´æ¥å› recordï¼Œæ¸›å°‘ä¸å¿…è¦çš„ç‰©ä»¶æ˜ å°„èˆ‡æ¨£æ¿ç¨‹å¼ç¢¼ã€‚


ç¼ºé»
	record åœ¨æ¬„ä½å¾ˆå¤šæ™‚ï¼Œå‘¼å«å»ºæ§‹å­æœƒè®Šå¾—åˆé•·åˆé†œï¼›ä½†æœ‰å¹¾å€‹å¯¦å‹™æ‹›å¯ä»¥æŠŠã€Œé•·åƒæ•¸åˆ—ã€çš„ç—›é»é™åˆ°å¾ˆä½ï¼š
	
	1) ä¸€è¡Œä¸€åƒæ•¸ï¼Œè®“å¯è®€æ€§å›ä¾†
		IDE è¨­å®šè‡ªå‹•æ›è¡Œï¼Œå‘¼å«ç«¯é€™æ¨£å¯«å¯è®€æ€§å…¶å¯¦ä¸å·®ï¼š
		var user = new User(
			"u01",
			"David",
			30,
			new Address("TW", "Taipei", "Xinyi Rd"),
			List.of("admin", "staff"),
			Instant.parse("2025-09-10T06:00:00Z")
		);
		æ¯å€‹åƒæ•¸éƒ½èƒ½æ¸…æ¥šå°é½Šèˆ‡å°æ‡‰å‹åˆ¥ï¼ŒPR review ä¹Ÿå®¹æ˜“ã€‚
	
	2) æŠŠæ¬„ä½åˆ†ç¾¤æˆæ›´å°çš„ Value Objects
		éé•·é€šå¸¸ä»£è¡¨æ¦‚å¿µæ··åœ¨ä¸€èµ·ã€‚æŠŠç›¸é—œæ¬„ä½æ‰“åŒ…æˆå°å‹ value object/å­ recordï¼Œè®“é ‚å±¤è®ŠçŸ­ã€èªæ„æ›´æ¸…æ¥šï¼š
			public record Name(String first, String last) {}
			public record Contact(String email, String phone) {}
			public record Address(String country, String city, String street) {}

			public record User(
				String id,
				Name name,
				Contact contact,
				Address address,
				List<String> roles
			) {}

		é ‚å±¤ User åƒæ•¸ç«‹å³ç¸®çŸ­ï¼Œé‚è¼¯èšåˆä¹Ÿæ›´å¥½ç¶­è­·ï¼ˆå£å‘³é“ç›´æ¥è®Šè¨­è¨ˆæ”¹å–„ï¼‰ã€‚

	3) ç”¨ JPQL constructor expression / æŠ•å½±ï¼Œè®“ã€Œå»ºæ§‹å¾ˆé•·ã€ç™¼ç”Ÿåœ¨ Repositoryï¼Œä¸æ˜¯åœ¨æ¥­å‹™é‚è¼¯
		ç•¶ä½ æ˜¯å¾ DB æŸ¥å‡º DTO æ™‚ï¼Œç”¨ select new ... ç›´æ¥å› recordï¼Œå‘¼å«ç«¯æ ¹æœ¬çœ‹ä¸åˆ°é•·åƒæ•¸ï¼š
			public record UserView(Long id, String name, String email, String city) {}

			@Query("""
			  select new com.example.api.UserView(u.id, u.name, u.email, u.address.city)
			  from User u
			  where u.status = :status
			""")
			List<UserView> findViewsByStatus(Status status);
		
		å‘¼å«ç«¯æ‹¿åˆ° UserViewï¼Œå®Œå…¨æ²’æœ‰æ‰‹å‹• new UserView(...) çš„é•·ä¸²åƒæ•¸å•é¡Œã€‚
	
	4) éœ€è¦ã€Œå…·ååƒæ•¸ã€æ„Ÿè¦ºï¼Ÿåœ¨å¤–é¢åŒ…ä¸€å±¤ Builder/Commandï¼Œå†è½‰æˆ record
		record å¤©ç”Ÿæ²’æœ‰ builderï¼Œä½†ä½ å¯ä»¥åœ¨é‚Šç•Œå±¤ï¼ˆæ¥æ”¶è¡¨å–®/JSON çš„åœ°æ–¹ï¼‰ç”¨å¯è®Šçš„ command/builderï¼Œ
		æœ€å¾Œä¸€æ¬¡æ€§è½‰ç‚ºä¸å¯è®Š recordï¼š

			// å¯è®Šçš„è¼¸å…¥ç‰©ä»¶ï¼ˆä¾‹å¦‚ MVC @RequestBodyï¼‰
			@Data
			public class CreateUserCmd {
			  private String id;
			  private String firstName;
			  private String lastName;
			  private String email;
			  private String phone;
			  private String country;
			  private String city;
			  private String street;
			}

			// ä¸å¯è®Šæ ¸å¿ƒæ¨¡å‹
			public record User(
				String id, Name name, Contact contact, Address address
			){}

			// è½‰æ›ï¼ˆæ‰‹å¯«æˆ–ç”¨ MapStructï¼‰
			static User toUser(CreateUserCmd c) {
			  return new User(
				  c.getId(),
				  new Name(c.getFirstName(), c.getLastName()),
				  new Contact(c.getEmail(), c.getPhone()),
				  new Address(c.getCountry(), c.getCity(), c.getStreet())
			  );
			}
		é€™æ¨£å‘¼å«ç«¯ç”¨ã€Œå…·åæ¬„ä½ã€å¡«è³‡æ–™ï¼Œæ ¸å¿ƒæ¨¡å‹ä»ç¶­æŒ record çš„ä¹¾æ·¨ä¸å¯è®Šã€‚
	
	5) é  JSON / YAML ç¶å®šä¾†ã€Œé¿é–‹æ‰‹å¯«é•·å»ºæ§‹å­ã€
		åœ¨ Spring è£¡ï¼Œrecord è·Ÿ Jackson å¾ˆåˆï¼š
			* Controller çš„ @RequestBody ç›´æ¥ç¶åˆ° recordï¼Œä½ ä¸ç”¨è‡ªå·±å¯« new Xxx(...)ã€‚
			* Spring Boot çš„è¨­å®šç¶å®šï¼ˆ@ConfigurationPropertiesï¼‰ä¹Ÿå¾ˆé©åˆç”¨ recordï¼ˆJava 16+ï¼‰ï¼Œç…§æ¨£è‡ªå‹•æ³¨å…¥ã€‚
	
	6) æä¾›ã€Œè¤‡è£½ with æ–¹æ³•ã€è®“æ”¹ä¸€å…©å€‹æ¬„ä½æ™‚ä¸å¿…é‡åˆ—æ‰€æœ‰åƒæ•¸
		record æ²’å…§å»º witherï¼Œä½†ä½ å¯ä»¥è‡ªå·±åŠ è¤‡è£½å·¥å» ï¼Œé‡å°è®Šå‹•å¸¸è¦‹çš„æ¬„ä½åšè¼•é‡ä¿®æ”¹ï¼š
			public record User(String id, String name, int age) {
			  public User withAge(int newAge) { return new User(id, name, newAge); }
			}
		ä½¿ç”¨æ™‚ç°¡çŸ­å®‰å…¨ï¼šuser = user.withAge(31);
		
	7) è‹¥å¾ˆå¤šæ¬„ä½éƒ½ã€Œå¯é¸/é¸å¡«ã€â†’ è€ƒæ…®æ”¹å› Class + @Builder
		ç•¶ä¸€å€‹å‹åˆ¥å……æ»¿ optional æ¬„ä½æˆ–çµ„åˆçˆ†ç‚¸ï¼Œrecord æœªå¿…æ˜¯æœ€ä½³è§£ã€‚
		é€™æ™‚å€™å‚³çµ± class + Lombok @Builderï¼ˆæˆ– Immutables/AutoValue é¡ä¼¼å·¥å…·ï¼‰æœƒæ›´èˆ’æœï¼š
			@Builder
			public class ReportOptions {
			  private String title;
			  private String author;
			  private Integer pageSize;
			  private Boolean includeToc;
			  // ...
			}
		é€™æ˜¯ã€Œéœ€æ±‚ä¸æ˜ç¢ºã€å¤šå¯é¸æ¬„ä½ã€çš„è¨Šè™Ÿï¼Œbuilder æœƒæ¯” record å‹å–„ã€‚
	å°çµ
		* åƒæ•¸é•· â‰  ä¸€å®šä¸å¥½ï¼›é—œéµåœ¨èªæ„èšåˆèˆ‡å‘¼å«ç«¯æ˜¯å¦éœ€è¦æ‰‹å‹•åˆ—å‡ºã€‚
		* å„ªå…ˆç”¨ï¼šåˆ†ç¾¤æˆå°å€¼ç‰©ä»¶ã€Repository ç«¯æŠ•å½±ã€åœ¨é‚Šç•Œå±¤ç”¨å¯è®Šè¼¸å…¥ç‰©ä»¶å†è½‰ recordã€‚
		* è‹¥æ¬„ä½å¤§å¤šå¯é¸æˆ–çµ„åˆå¾ˆå¤š â†’ ç”¨ Builder æ¨¡å¼çš„ class æ‰æ˜¯ç‹é“ã€‚