å·²çŸ¥é›£é»
	1.å‰ç«¯vue3 æ‹†åˆ†å¾Œçš„å‰å¾Œè®ŠåŒ–å·®ç•°
	2.å‰ç«¯ä¸è¦ç›´æ¥æ‰“å¾Œç«¯+ä¸è¦ç¶­è­·tokenï¼Œå‰ç«¯åªè¦æ‰“BFF
	3.BFF èˆ‡å¾Œç«¯ api ä¸€è‡´æ€§ç¶­è­·æ–¹å¼
	4.æœ‰ç™»å…¥ç³»çµ±çš„ BFF è¦ redis session è™•ç†æ©«å‘æ“´å±•
	5.è‹¥è¦æœ‰ token rotation è¦æœ‰ vault/ä¿å¯†å™¨ + config server åŒæ­¥
	

ç³»çµ±é …ç›®
	web server
		nginx			(å®¹å™¨æœå‹™)

	å‰ç«¯ (vue3 gen)
		ç„¡ç™»å…¥ç³»çµ±é¡
			noLogin-d-spa
		çµ±ä¸€ç™»å…¥ç³»çµ±é¡
			portal-spa
			å­ç³»çµ±
				a-spa
				b-spa
				c-spa

	ä¸­é–“å±¤ (java) // æ›è¼‰åœ¨ gateway-server ä¹‹å‰ï¼Œå°ˆé–€è®“å‰ç«¯æ‰“
		noLogin-d-bff	(ç„¡ç‹€æ…‹)
		portal-bff		(æœ‰ç‹€æ…‹)
			éœ€è¦ redis session è™•ç†æ©«å‘æ“´å±•çš„ session
		å­ç³»çµ±
			a-bff
			b-bff
			c-bff
			é€šç”¨-bff

	åŸºç¤å»ºè¨­
		auth-server			(java)
		gateway-server 		(java)
		radis				(å®¹å™¨æœå‹™) 
			1.for BFF redis session ä»¥åˆ© csrf of Session Cookie é˜²è­·å•é¡Œ
		// config-server	(java)
		// vault			(å®¹å™¨æœå‹™)

	å¾Œç«¯ (java)
		portal-bn
		å­ç³»çµ±
			a-bn
			b-bn
			c-bn
			é€šç”¨-bn


å°å¤–å…¥å£ï¼š
	nginx

		/ â†’ portal SPAï¼ˆéœæ…‹æª”ï¼‰

		/bff/** â†’ portal-bff

		/oauth2/** æˆ– /auth/** â†’ auth-serverï¼ˆæˆ–ç¶“ nginx è½‰ç™¼ï¼‰

		/api/** â†’ gateway-server

å…§éƒ¨å‘¼å«ï¼š
	portal-bff 	â†’ gateway-server 	â†’ portal-service
	a-bff 		â†’ gateway-server	â†’ a-service
	b-bff		â†’ gateway-server	â†’ b-service
	c-bff		â†’ gateway-server	â†’ c-service

é€™æ¨£åˆ‡çš„å¥½è™•æ˜¯ï¼š

	* BFF(Backend for frontend) çš„å­˜åœ¨ç›®çš„å°±æ˜¯è™•ç†ã€Œç€è¦½å™¨ç‰¹æ®Šéœ€æ±‚ã€ï¼ˆcookieã€sessionã€CSRFã€é˜² token å¤–æ´©ã€èšåˆå¤š APIï¼‰ã€‚å®ƒæ˜¯ã€Œå‰ç«¯çš„å»¶ä¼¸ã€ï¼Œä¸å¤ªåƒä¸€èˆ¬å¾Œç«¯å­ç³»çµ±ã€‚

	* é¿å… gateway è®Šæˆã€Œæ‰€æœ‰æ±è¥¿éƒ½è¦å…ˆéä¸€å±¤ã€ï¼ŒæŠŠ gateway çš„è²¬ä»»é™ç¸®åœ¨ã€Œä¿è­·å¾Œç«¯ APIã€ã€‚

	* ä½ å¯ä»¥è®“ portal-bff ç”¨ cookie-based sessionï¼ˆHttpOnly + SameSite + Secureï¼‰ï¼Œç€è¦½å™¨å®Œå…¨ä¸ç¢° access tokenï¼›portal-bff å†ç”¨ tokenï¼ˆæˆ– token exchange å¾Œçš„ tokenï¼‰å»æ‰“ gateway / å¾Œç«¯ã€‚

	é€™æ˜¯æœ€å¤šåœ˜éšŠæœ€å¾Œæœƒè½åœ¨çš„æ¨£å­ï¼šç€è¦½å™¨åªä¿¡ä»» BFF çš„ cookieï¼›BFF æ‰æ˜¯ token çš„æŒæœ‰è€…ã€‚


æœ€å¸¸è¦‹çš„äº’å‹•æ¨¡å¼ï¼šPortal åªè² è²¬ã€Œå°æµã€+ã€ŒSSOã€
	1) ä½¿ç”¨è€…åœ¨ Portal å®Œæˆ SSOï¼ˆå»ºç«‹ç™»å…¥ç‹€æ…‹ï¼‰

		Portal SPA â†” portal-bffï¼ˆsession cookieï¼‰

		portal-bff â†” auth-serverï¼ˆæ› token / refresh / token exchange è¦–ä½ çš„è¨­è¨ˆï¼‰
			BY Authorization Code + PKCE

	2) ä½¿ç”¨è€…é»é¸å­ç³»çµ± a/b/cï¼Œè·³åˆ°å­ç³»çµ±å‰ç«¯

		ä½¿ç”¨è€…è·³åˆ° https://portal.domain/a/ æˆ– https://a.domain/ï¼ˆçœ‹ä½ æ˜¯å¦åŒç¶²åŸŸï¼‰

		å­ç³»çµ±å‰ç«¯è‡ªå·±è¦æœ‰ã€Œç™»å…¥æª¢æŸ¥ã€èˆ‡ã€Œå–å¾—å‘¼å« API çš„æ†‘è­‰ã€çš„ç­–ç•¥

	é—œéµå·®åˆ¥åœ¨æ–¼ï¼š
		ğŸ‘‰ Portal è² è²¬è®“ä½¿ç”¨è€…ã€Œå·²ç™»å…¥ï¼ˆSSOï¼‰ã€
		ğŸ‘‰ å­ç³»çµ±å‰ç«¯è² è²¬è®“è‡ªå·±ã€Œèƒ½å‘¼å« APIï¼ˆæ‹¿åˆ°è‡ªå·±çš„ access token æˆ– sessionï¼‰ã€


å­ç³»çµ±å‰ç«¯åˆ°åº•è¦ä¸è¦ç¶“ portal-bffï¼Ÿä¸‰ç¨®æˆç†Ÿåšæ³•

	åšæ³• Aï¼ˆæœ€æ¨è–¦ï¼Œä¹¾æ·¨ï¼‰ï¼šæ¯å€‹å­ç³»çµ±æœ‰è‡ªå·±çš„ BFFï¼ˆa-bff / b-bff / c-bffï¼‰

	äº’å‹•ï¼š

		* a-spa â†” a-bffï¼ˆcookie sessionï¼‰

		* a-bff â†” auth-serverï¼ˆå¿…è¦æ™‚ token exchange / refreshï¼‰

		* a-bff â†” gateway-server â†” a-service

	Portal åšä»€éº¼ï¼Ÿ

		* Portal åªæä¾›ã€Œå…¥å£ã€èˆ‡ã€Œç³»çµ±æ¸…å–®ã€

		* é» a é€£çµå°±é–‹ a-spa

		* a-spa ç™¼ç¾æ²’æœ‰ session â†’ å°å‘ auth-serverï¼ˆåŒ SSO session ä¸‹é€šå¸¸æœƒç›´æ¥ç„¡æ„Ÿç™»å…¥ï¼‰â†’ å›åˆ° a-bff å»ºç«‹ cookie session

	å„ªé»ï¼š

		* é‚Šç•Œè¶…æ¸…æ¥šï¼šæ¯å€‹ç³»çµ±è‡ªå·±çš„ cookieã€è‡ªå·±çš„ CSRFã€é˜²è­·ç­–ç•¥

		* æ¬Šé™èˆ‡ç¨½æ ¸ä¹Ÿæ¯”è¼ƒè‡ªç„¶ï¼ˆç³»çµ±è‡ªå·±çš„æ“ä½œåœ¨ç³»çµ±è‡ªå·±çš„ BFFï¼‰

		* Portal ä¸æœƒè®Šæˆå…¨åŸŸç“¶é ¸

	ç¼ºé»ï¼š

		ç³»çµ±å¤šå°±å¤šå¹¾å€‹ BFFï¼ˆä½†é€™æ˜¯å¯æ§çš„å·¥ç¨‹é‡ï¼‰